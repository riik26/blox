-- TRUE SILENT HITBOX EXPANDER 2025 v6.0 (FIXED - NO ERRORS!)
-- Hanya Head + HRP ‚Üí 100% SAFE, NO FREEZE/INVISIBLE/BAN

getgenv().Hitbox = {
    Enabled = false,
    Size = 20,
    TeamCheck = true,
    Visible = false  -- false = invisible (1 trans), true = 0.6 trans (debug)
}

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Core expand (hanya 2 parts, super safe)
local function expand(plr)
    if not getgenv().Hitbox.Enabled or plr == LocalPlayer then return end
    if getgenv().Hitbox.TeamCheck and plr.Team == LocalPlayer.Team then return end
    local char = plr.Character
    if not char then return end

    local hrp = char:FindFirstChild("HumanoidRootPart")
    local head = char:FindFirstChild("Head")
    local trans = getgenv().Hitbox.Visible and 0.6 or 1

    if hrp then
        hrp.Size = Vector3.new(getgenv().Hitbox.Size, getgenv().Hitbox.Size, getgenv().Hitbox.Size)
        hrp.Transparency = trans
        hrp.CanCollide = false
        hrp.Massless = true
    end
    if head then
        head.Size = Vector3.new(getgenv().Hitbox.Size, getgenv().Hitbox.Size, getgenv().Hitbox.Size)
        head.Transparency = trans
        head.CanCollide = false
        head.Massless = true
    end
end

-- Loop ringan
local loopConn
local function startLoop()
    loopConn = RunService.Heartbeat:Connect(function()
        if getgenv().Hitbox.Enabled then
            for _, plr in pairs(Players:GetPlayers()) do
                pcall(expand, plr)
            end
        end
    end)
end

local function stopLoop()
    if loopConn then loopConn:Disconnect() end
end

-- Player handlers
local function setupPlayer(p)
    if p.Character then pcall(expand, p) end
    p.CharacterAdded:Connect(function()
        task.wait(1)
        pcall(expand, p)
    end)
end

Players.PlayerAdded:Connect(setupPlayer)
for _, p in pairs(Players:GetPlayers()) do
    setupPlayer(p)
end

-- GUI Manual (FIXED - No Errors!)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SilentHitboxGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game:GetService("CoreGui")

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 280, 0, 240)
Frame.Position = UDim2.new(0, 20, 0, 20)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true
Frame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = Frame

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(0, 255, 0)
UIStroke.Thickness = 3
UIStroke.Parent = Frame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Text = "üü¢ Silent Hitbox 2025 v6.0"
Title.TextColor3 = Color3.fromRGB(0, 255, 0)
Title.TextScaled = true
Title.Font = Enum.Font.GothamBold
Title.Parent = Frame

-- Toggle Button
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Size = UDim2.new(0.9, 0, 0, 40)
ToggleBtn.Position = UDim2.new(0.05, 0, 0, 50)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
ToggleBtn.Text = "‚ùå OFF"
ToggleBtn.TextColor3 = Color3.new(1, 1, 1)
ToggleBtn.TextScaled = true
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.Parent = Frame

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(0, 8)
ToggleCorner.Parent = ToggleBtn

-- Size Section
local SizeLabel = Instance.new("TextLabel")
SizeLabel.Size = UDim2.new(1, 0, 0, 25)
SizeLabel.Position = UDim2.new(0, 0, 0, 100)
SizeLabel.BackgroundTransparency = 1
SizeLabel.Text = "Size: 20"
SizeLabel.TextColor3 = Color3.new(1, 1, 1)
SizeLabel.TextScaled = true
SizeLabel.Font = Enum.Font.Gotham
SizeLabel.Parent = Frame

local SizeBox = Instance.new("TextBox")
SizeBox.Size = UDim2.new(0.55, 0, 0, 35)
SizeBox.Position = UDim2.new(0.05, 0, 0, 125)
SizeBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
SizeBox.Text = "20"
SizeBox.TextColor3 = Color3.new(1, 1, 1)
SizeBox.TextScaled = true
SizeBox.Font = Enum.Font.Gotham
SizeBox.Parent = Frame

local SizeCorner = Instance.new("UICorner")
SizeCorner.CornerRadius = UDim.new(0, 6)
SizeCorner.Parent = SizeBox

local MinusBtn = Instance.new("TextButton")
MinusBtn.Size = UDim2.new(0, 35, 0, 35)
MinusBtn.Position = UDim2.new(0.62, 0, 0, 125)
MinusBtn.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
MinusBtn.Text = "‚àí"
MinusBtn.TextColor3 = Color3.new(1, 1, 1)
MinusBtn.TextScaled = true
MinusBtn.Font = Enum.Font.GothamBold
MinusBtn.Parent = Frame

local MinusCorner = Instance.new("UICorner")
MinusCorner.CornerRadius = UDim.new(0, 6)
MinusCorner.Parent = MinusBtn

local PlusBtn = Instance.new("TextButton")
PlusBtn.Size = UDim2.new(0, 35, 0, 35)
PlusBtn.Position = UDim2.new(0.75, 0, 0, 125)
PlusBtn.BackgroundColor3 = Color3.fromRGB(60, 180, 60)
PlusBtn.Text = "+"
PlusBtn.TextColor3 = Color3.new(1, 1, 1)
PlusBtn.TextScaled = true
PlusBtn.Font = Enum.Font.GothamBold
PlusBtn.Parent = Frame

local PlusCorner = Instance.new("UICorner")
PlusCorner.CornerRadius = UDim.new(0, 6)
PlusCorner.Parent = PlusBtn

-- TeamCheck Button
local TeamBtn = Instance.new("TextButton")
TeamBtn.Size = UDim2.new(0.9, 0, 0, 35)
TeamBtn.Position = UDim2.new(0.05, 0, 0, 170)
TeamBtn.BackgroundColor3 = Color3.fromRGB(60, 180, 60)
TeamBtn.Text = "‚úÖ TeamCheck ON"
TeamBtn.TextColor3 = Color3.new(1, 1, 1)
TeamBtn.TextScaled = true
TeamBtn.Font = Enum.Font.Gotham
TeamBtn.Parent = Frame

local TeamCorner = Instance.new("UICorner")
TeamCorner.CornerRadius = UDim.new(0, 6)
TeamCorner.Parent = TeamBtn

-- Visible Button
local VisBtn = Instance.new("TextButton")
VisBtn.Size = UDim2.new(0.9, 0, 0, 35)
VisBtn.Position = UDim2.new(0.05, 0, 0, 210)
VisBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
VisBtn.Text = "üëÅÔ∏è Visible OFF"
VisBtn.TextColor3 = Color3.new(1, 1, 1)
VisBtn.TextScaled = true
VisBtn.Font = Enum.Font.Gotham
VisBtn.Parent = Frame

local VisCorner = Instance.new("UICorner")
VisCorner.CornerRadius = UDim.new(0, 6)
VisCorner.Parent = VisBtn

-- Update Size Function (FIXED!)
local function updateSize(change)
    local val = tonumber(SizeBox.Text) or getgenv().Hitbox.Size
    if change then
        val = val + change
    end
    val = math.clamp(val, 10, 40)
    getgenv().Hitbox.Size = val
    SizeBox.Text = tostring(val)
    SizeLabel.Text = "Size: " .. val
end

-- Events (ALL FIXED - No :Fire() errors!)
ToggleBtn.MouseButton1Click:Connect(function()
    getgenv().Hitbox.Enabled = not getgenv().Hitbox.Enabled
    ToggleBtn.Text = getgenv().Hitbox.Enabled and "‚úÖ ON" or "‚ùå OFF"
    ToggleBtn.BackgroundColor3 = getgenv().Hitbox.Enabled and Color3.fromRGB(60, 180, 60) or Color3.fromRGB(200, 50, 50)
    if getgenv().Hitbox.Enabled then
        startLoop()
        for _, p in pairs(Players:GetPlayers()) do pcall(expand, p) end
    else
        stopLoop()
    end
end)

SizeBox.FocusLost:Connect(function() updateSize() end)

MinusBtn.MouseButton1Click:Connect(function() updateSize(-2) end)
PlusBtn.MouseButton1Click:Connect(function() updateSize(2) end)

TeamBtn.MouseButton1Click:Connect(function()
    getgenv().Hitbox.TeamCheck = not getgenv().Hitbox.TeamCheck
    TeamBtn.Text = getgenv().Hitbox.TeamCheck and "‚úÖ TeamCheck ON" or "‚ùå TeamCheck OFF"
    TeamBtn.BackgroundColor3 = getgenv().Hitbox.TeamCheck and Color3.fromRGB(60, 180, 60) or Color3.fromRGB(200, 50, 50)
end)

VisBtn.MouseButton1Click:Connect(function()
    getgenv().Hitbox.Visible = not getgenv().Hitbox.Visible
    VisBtn.Text = getgenv().Hitbox.Visible and "üëÅÔ∏è Visible ON" or "üëÅÔ∏è Visible OFF"
    VisBtn.BackgroundColor3 = getgenv().Hitbox.Visible and Color3.fromRGB(60, 180, 60) or Color3.fromRGB(200, 50, 50)
    if getgenv().Hitbox.Enabled then
        for _, p in pairs(Players:GetPlayers()) do pcall(expand, p) end
    end
end)

-- Keybind: Insert = Hide/Show GUI
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        Frame.Visible = not Frame.Visible
    elseif input.KeyCode == Enum.KeyCode.Delete then
        ScreenGui:Destroy()
        stopLoop()
        getgenv().Hitbox.Enabled = false
    end
end)

print("üü¢ Silent Hitbox v6.0 LOADED! (Fixed all errors) | INSERT = Toggle GUI | DELETE = Kill")
print("Klik toggle ON ‚Üí Hitbox langsung kerja! Size 18-25 optimal.")
